#Deploy fronted Sitrep

#create the resource group 
az group create --name sitrep_registry --location eastus

#create the webplan to host the apps az appservice plan create
--name webplan
--resource-group sitrep_registry
--sku B1
--is-linux
Deploy backend Sitrep

CD into the folder containing the code

#not needed if the resource group has already been created az group create --name sitrep_registry --location eastus

#create the container registry

az acr create --resource-group sitrep_registry --name sitrepback --sku Basic --admin-enabled true

ACR_PASSWORD=$(az acr credential show
--resource-group sitrep_registry
--name sitrepback
--query "passwords[?name == 'password'].value"
--output tsv)

#build the docker image az acr build
--resource-group sitrep_registry
--registry sitrepback
--image sitrepback:latest .

#deploy the web app #the container password needs to be retrieved from the access keys in azure UI az webapp create
--resource-group sitrep_registry
--plan webplan --name sitrepapi
--docker-registry-server-password
--docker-registry-server-user sitrepback
--role acrpull
--deployment-container-image-name sitrepback.azurecr.io/sitrepback:latest
